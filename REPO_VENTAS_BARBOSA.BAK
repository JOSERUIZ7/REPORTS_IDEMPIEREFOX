A1  =  " select ao.name as ad_org_N,x.typecustomer ,x.typecustomern ,x.value ,x.m_product_n ,x.qtyinvoiced ,x.linenetamt_cv , "
A2  =  " x.tax_line_cv ,x.total_line_cv ,x.qty_ton ,x.uomsymbol ,x.nivel from  "
A3  =  " (select a.ad_org_id,case when A.issocialprogram = 'Y' then '2 Programa Social' when A.IsMassiveConsume = 'Y' then '1 Consumo Masivo'  "
A4  =  " when A.IsIndustrialSales = 'Y' then '3 Ventas Industriales' end TypeCustomer,  "
A5  =  " case when MAX(A.issocialprogram) = 'Y' then 'Programa Social' when MAX(A.IsMassiveConsume) = 'Y' then 'Consumo Masivo'  "
A6  =  " when MAX(A.IsIndustrialSales) = 'Y' then 'Ventas Industriales' end TypeCustomerN, a.value,MAX(a.m_product_description) as m_product_n ,  "
A7 =  " sum(a.qtyinvoiced) qtyinvoiced ,round(sum(currencyconvert(a.linenetamt, a.c_currency_id , 100, a.dateinvoiced , a.C_ConversionType_ID , a.ad_client_id, "
A8  =  " a.ad_org_id)),2) linenetamt_cv ,round(sum(currencyConvert((a.linenetamt * (a.rate / 100::numeric)),a.c_currency_id,100,a.dateinvoiced,a.C_ConversionType_ID, "
A9  =  " a.AD_CLIENT_ID, a.AD_ORG_ID )),2) as tax_line_cv,ROUND(sum(currencyConvert(((a.linenetamt + (a.linenetamt * (a.rate / 100::numeric)) )),a.c_currency_id,100,a.dateinvoiced, "
A0  =  " a.C_ConversionType_ID,a.AD_CLIENT_ID,a.AD_ORG_ID )),2) as total_line_cv,( CASE WHEN MAX(a.DocBaseType) IN ('ARI','ARC') THEN 'Analisis de Ventas por Producto' " && WHEN MAX(a.DocBaseType) IN ('API','APC') THEN 'Analisis de Compras por Producto' END) REPONAME , "
A11  =  " 'Montos expresados en: '|| max(cu.Description) || CHR(13) || 'DESDE: '|| substring('2023-08-01',9,2) || '/'|| substring('2023-08-01',6,2) ||'/'|| substring('2023-08-01',1,4) "
A12  =  " || ' - HASTA:'|| substring('2023-08-15',9,2) || '/'|| substring('2023-08-15',6,2) ||'/'|| substring('2023-08-15',1,4) || CHR(13) ||  "
A13  =  " case when $P{AD_Org_ID} is null then '' else ' Solo organizacion: ' || MAX(b.name) || ' - ' end ||case when $P{C_DocType_ID} is null then '' else ' Solo Documentos: ' || max(cd.name) || ' - ' end || "
A14  =  " case when $P{C_BP_Group_ID} is null then '' else ' Solo Grupo de terceros: ' || max(bpg.name) || ' - ' end || case when $P{M_Product_Category_ID} is null then '' else ' Solo Categoria de productos: ' || max(mpc.name) || ' - ' end || "
A15  =  " case when $P{M_Product_ID} is null then '' else ' Solo Producto: ' || max(d.name) end as doc_info,round(sum(a.qtyinvoiced)/1000,2) qty_ton,max(cum.name) UOMSymbol, 1 NIVEL "
A16  =  " from  "
A17  =  " cop_rv_c_invoiceline a left join m_product d on a.m_product_id = d.m_product_id join ad_org b on a.ad_org_id = b.ad_org_id join C_Currency cu on cu.c_currency_id = 100 "
A18  =  " join c_doctype cd on a.C_DocType_ID = cd.C_DocType_ID join C_BP_Group bpg on a.C_BP_Group_ID = bpg.C_BP_Group_ID  join M_Product_Category mpc on a.M_Product_Category_ID = mpc.M_Product_Category_id "
A19  =  " join C_UOM cum on d.C_UOM_ID=cum.C_UOM_ID where a.ad_client_id = 1000000 and A.M_PRODUCT_ID is not NULL "
A20  =  " and A.DOCSTATUS = 'CO' AND A.M_Product_Category_ID <> 1000064 and a.DateInvoiced between '2023-08-01' and '2023-08-15' "
A21  =  " and a.issotrx = 'Y' and  "
A22  =  " case when 'N' = 'N' and 'N' = 'N' and 'N' = 'N' "
A23  =  " then ( 'Y' not in (a.IsDiscount,a.IsEndowment,a.IsDonation)) "
A24  =  " when 'N' = 'Y' and 'N' = 'Y' and 'N' = 'Y' "
A25  =  " then 1=1  "
A26  =  " when 'N' = 'Y' and 'N' = 'Y' and 'N' = 'N' "
A27  =  " then ( 'Y' not in (A.IsDonation)) "
A28  =  " when 'N' = 'Y' and 'N' = 'N' and 'N' = 'N' "
A29  =  " then ( 'Y' not in (a.IsEndowment,a.IsDonation)) "
A30  =  " when 'N' = 'N' and 'N' = 'N' and 'N' = 'Y' "
A31  =  " then ( 'Y' not in (a.IsDiscount,a.IsEndowment))  "
A32  =  " when 'N' = 'N' and 'N' = 'Y' and 'N' = 'Y' "
A33  =  " then ( 'Y' not in (a.IsDiscount))  "
A34  =  " when 'N' = 'N' and 'N' = 'Y' and 'N' = 'N' "
A35  =  " then ( 'Y' not in (a.IsDiscount,a.IsDonation))  "
A36  =  " end and (a.C_BPartner_ID = $P{C_BPartner_ID} or $P{C_BPartner_ID} is null) and (a.AD_Org_ID = $P{AD_Org_ID} or $P{AD_Org_ID} is null) "
A37  =  " and (a.C_BP_Group_ID = $P{C_BP_Group_ID} or $P{C_BP_Group_ID} is null) and (a.M_Product_Category_ID = $P{M_Product_Category_ID} or $P{M_Product_Category_ID} is null) "
A38  =  " and (a.SalesRep_ID = $P{SalesRep_ID} or $P{SalesRep_ID} is null) and (a.M_Product_ID = $P{M_Product_ID} or $P{M_Product_ID} is null) "
A39  =  " and (a.C_DocType_ID = $P{C_DocType_ID} OR $P{C_DocType_ID} IS NULL) and a.c_doctypetarget_id not in (select c_doctype_id from C_DocType where NAME like '%Débito%' or name like '%Debito%')  " &&--0401
A40  =  " group by a.ad_org_id,TypeCustomer, a.value "
A41  =  " union "
A42  =  " select a.ad_org_id,case when A.issocialprogram = 'Y' then '2 Programa Social' when A.IsMassiveConsume = 'Y' then '1 Consumo Masivo'  "
A43  =  " when A.IsIndustrialSales = 'Y' then '3 Ventas Industriales' end TypeCustomer,case when MAX(A.issocialprogram) = 'Y' then 'Programa Social'  "
A44  =  " when MAX(A.IsMassiveConsume) = 'Y' then 'Consumo Masivo' when MAX(A.IsIndustrialSales) = 'Y' then 'Ventas Industriales' end TypeCustomerN,  "
A45  =  " null as value,null m_product_n , sum(a.qtyinvoiced) qtyinvoiced ,null linenetamt_cv ,null tax_line_cv ,null total_line_cv ,null reponame,  "
A46  =  " null doc_info,0 qty_ton,max(cum.name) UOMSymbol, 2 NIVEL from cop_rv_c_invoiceline a "
A47  =  " left join m_product d on a.m_product_id = d.m_product_id join ad_org b on a.ad_org_id = b.ad_org_id "
A48  =  " join C_Currency cu on cu.c_currency_id = 100 join c_doctype cd on a.C_DocType_ID = cd.C_DocType_ID "
A49  =  " join C_BP_Group bpg on a.C_BP_Group_ID = bpg.C_BP_Group_ID join M_Product_Category mpc on a.M_Product_Category_ID = mpc.M_Product_Category_id "
A50  =  " join C_UOM cum on d.C_UOM_ID=cum.C_UOM_ID "
A51  =  " where a.ad_client_id = 1000000 and A.M_PRODUCT_ID is not NULL and A.DOCSTATUS = 'CO' AND A.M_Product_Category_ID <> 1000064 "
A52  =  " and a.DateInvoiced between '2023-08-01' and '2023-08-15' and a.issotrx = 'Y' "
A53  =  " and case when 'N' = 'N' and 'N' = 'N' and 'N' = 'N' "
A54  =  " then ( 'Y' not in (a.IsDiscount,a.IsEndowment,a.IsDonation)) when 'N' = 'Y' and 'N' = 'Y' and 'N' = 'Y' "
A55  =  " then 1=1 when 'N' = 'Y' and 'N' = 'Y' and 'N' = 'N' then ( 'Y' not in (A.IsDonation)) "
A56  =  " when 'N' = 'Y' and 'N' = 'N' and 'N' = 'N' then ( 'Y' not in (a.IsEndowment,a.IsDonation)) "
A57  =  " when 'N' = 'N' and 'N' = 'N' and 'N' = 'Y' then ( 'Y' not in (a.IsDiscount,a.IsEndowment))  " 
A58  =  " when 'N' = 'N' and 'N' = 'Y' and 'N' = 'Y' then ( 'Y' not in (a.IsDiscount))  "
A59  =  " when 'N' = 'N' and 'N' = 'Y' and 'N' = 'N' then ( 'Y' not in (a.IsDiscount,a.IsDonation))  "
A60  =  " end and (a.C_BPartner_ID = $P{C_BPartner_ID} or $P{C_BPartner_ID} is null) and (a.AD_Org_ID = $P{AD_Org_ID} or $P{AD_Org_ID} is null) "
A61  =  " and (a.C_BP_Group_ID = $P{C_BP_Group_ID} or $P{C_BP_Group_ID} is null) and (a.M_Product_Category_ID = $P{M_Product_Category_ID} or $P{M_Product_Category_ID} is null) "
A62  =  " and (a.SalesRep_ID = $P{SalesRep_ID} or $P{SalesRep_ID} is null) and (a.M_Product_ID = $P{M_Product_ID} or $P{M_Product_ID} is null) "
A63  =  " and (a.C_DocType_ID = $P{C_DocType_ID} OR $P{C_DocType_ID} IS NULL) and a.c_doctypetarget_id not in (select c_doctype_id from C_DocType where NAME like '%Débito%' or name like '%Debito%')  " &&--0401
A64  =  " group by a.ad_org_id,TypeCustomer,uomsymbol "
A65  =  " union  "
A66  =  " select a.ad_org_id, null TypeCustomer, null TypeCustomern, null as value, null m_product_n ,  sum(a.qtyinvoiced) qtyinvoiced , "
A67  =  " null linenetamt_cv ,null tax_line_cv ,null total_line_cv ,null reponame, null doc_info, 0 qty_ton, max(cum.name) UOMSymbol, 3 NIVEL "
A68  =  " from cop_rv_c_invoiceline a left join m_product d on a.m_product_id = d.m_product_id  join ad_org b on a.ad_org_id = b.ad_org_id "
A69  =  " join C_Currency cu on cu.c_currency_id = 100 join c_doctype cd on a.C_DocType_ID = cd.C_DocType_ID join C_BP_Group bpg on a.C_BP_Group_ID = bpg.C_BP_Group_ID  "
A70  =  " join M_Product_Category mpc on a.M_Product_Category_ID = mpc.M_Product_Category_id join C_UOM cum on d.C_UOM_ID=cum.C_UOM_ID "
A71  =  " where a.ad_client_id = 1000000 and A.M_PRODUCT_ID is not NULL and A.DOCSTATUS = 'CO' AND A.M_Product_Category_ID <> 1000064 "
A72  =  " and a.DateInvoiced between '2023-08-01' and '2023-08-15' and a.issotrx = 'Y' "
A73  =  " and case when 'N' = 'N' and 'N' = 'N' and 'N' = 'N' "
A74  =  " then ( 'Y' not in (a.IsDiscount,a.IsEndowment,a.IsDonation)) when 'N' = 'Y' and 'N' = 'Y' and 'N' = 'Y' then 1=1  "
A75  =  " when 'N' = 'Y' and 'N' = 'Y' and 'N' = 'N' then ( 'Y' not in (A.IsDonation)) when 'N' = 'Y' and 'N' = 'N' and 'N' = 'N' "
A76  =  " then ( 'Y' not in (a.IsEndowment,a.IsDonation)) when 'N' = 'N' and 'N' = 'N' and 'N' = 'Y' then ( 'Y' not in (a.IsDiscount,a.IsEndowment))  "
A77  =  " when 'N' = 'N' and 'N' = 'Y' and 'N' = 'Y' then ( 'Y' not in (a.IsDiscount))  when 'N' = 'N' and 'N' = 'Y' and 'N' = 'N' "
A78  =  " then ( 'Y' not in (a.IsDiscount,a.IsDonation)) end and (a.C_BPartner_ID = $P{C_BPartner_ID} or $P{C_BPartner_ID} is null) and (a.AD_Org_ID = $P{AD_Org_ID} or $P{AD_Org_ID} is null) "
A79  =  " and (a.C_BP_Group_ID = $P{C_BP_Group_ID} or $P{C_BP_Group_ID} is null) and (a.M_Product_Category_ID = $P{M_Product_Category_ID} or $P{M_Product_Category_ID} is null) "
A80  =  " and (a.SalesRep_ID = $P{SalesRep_ID} or $P{SalesRep_ID} is null) and (a.M_Product_ID = $P{M_Product_ID} or $P{M_Product_ID} is null) "
A81  =  " and (a.C_DocType_ID = $P{C_DocType_ID} OR $P{C_DocType_ID} IS NULL) and a.c_doctypetarget_id not in (select c_doctype_id from C_DocType where NAME like '%Débito%' or name like '%Debito%') "
A82  =  " group by a.ad_org_id,uomsymbol ) as x join ad_org ao on x.ad_org_id=ao.ad_org_id where (x.TypeCustomerN = $P{TypeCustomer} or $P{TypeCustomer} is null)  "
A83  =  " group by x.ad_org_id,ao.name,TypeCustomer,TypeCustomerN, x.value, m_product_n,qtyinvoiced,linenetamt_cv, tax_line_cv, total_line_cv, reponame, doc_info, qty_ton,uomsymbol,nivel "
A84  =  " order by x.ad_org_id,TypeCustomer,nivel,m_product_n,uomsymbol "